(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"23bf":function(e,t,n){"use strict";var r=n("53c1"),a=n.n(r);a.a},"53c1":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=n("76a0"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e._m(0),n("UploadPane"),n("Preview")],1)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-tip-wrapper"},[n("p",[e._v("提示")]),n("p",[e._v("- 微信/手机QQ 端使用「长按底部图片」进行保存")]),n("p",[e._v("- 其他端点击「下载按钮」进行保存")])])}];n("d3b7");function s(e){var t=new FileReader;return new Promise((function(n,r){t.onload=function(e){var t=e.target.result;n(t)},t.readAsDataURL(e)}))}function c(e){return new Promise((function(t,n){var r=new Image;r.setAttribute("crossOrigin","Anonymous"),r.onload=function(){t(r)},r.onerror=function(){n(arguments)},r.src=e}))}var u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preview-wrapper"},[n("div",{staticClass:"common-row operator"},[n("mt-button",{attrs:{type:"primary",size:"small",disabled:e.disabled},on:{click:e.draw}},[e._v(e._s(e.base64Img?"重新生成":"生成"))]),n("mt-button",{attrs:{type:"primary",size:"small",disabled:e.disabled},on:{click:e.download}},[e._v("下载")])],1),n("div",{staticClass:"divide"}),e.base64Img?n("div",[n("img",{attrs:{src:e.base64Img}})]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[n("canvas",{ref:"canvas"})])])},l=[],d=n("5530"),p=n("2f62"),h={name:"Preview",data:function(){return{ctx:null,base64Img:null}},computed:Object(d["a"])(Object(d["a"])({},Object(p["b"])(["posterImg","qrcodeImg"])),{},{disabled:function(){return!this.posterImg||!this.qrcodeImg}}),watch:{posterImg:function(e){var t=this;this.$nextTick((function(){t.draw()}))},qrcodeImg:function(e){var t=this;this.$nextTick((function(){t.draw()}))}},methods:{draw:function(){if(!this.disabled){this.initCanvas(),this.ctx.drawImage(this.posterImg,0,0);var e={x:795/1125*this.posterImg.width,y:1906/2436*this.posterImg.height,width:250/1125*this.posterImg.width,height:250/2436*this.posterImg.height};this.ctx.drawImage(this.qrcodeImg,e.x,e.y,e.width,e.height);var t=this.$refs["canvas"];this.base64Img=t.toDataURL("image/png")}},initCanvas:function(){var e=this.$refs["canvas"],t=e.getContext("2d");e.width=this.posterImg.width,e.height=this.posterImg.height,e.style.width="100%",this.ctx=t},download:function(){var e=document.createElement("a");e.download="pic_".concat(Date.now(),".png"),e.href=this.base64Img,e.click()}}},f=h,m=(n("9b6e"),n("2877")),g=Object(m["a"])(f,u,l,!1,null,"f3eb3bbe",null),v=g.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-pane-wrapper"},[n("div",{staticClass:"common-row"},[n("mt-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleClickUpload("POSTER")}}},[e._v("上传海报")]),n("mt-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleClickUpload("QRCODE")}}},[e._v("上传二维码")])],1),n("div",{staticClass:"filename-list"},[n("p",[e._v("海报文件名: "+e._s(this.posterFile&&this.posterFile.name))]),n("p",[e._v("二维码文件名: "+e._s(this.qrcodeFile&&this.qrcodeFile.name))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[n("input",{ref:"poster-input",attrs:{type:"file"},on:{change:e.posterUploadChange}}),n("input",{ref:"qrcode-input",attrs:{type:"file"},on:{change:e.qrcodeUploadChange}})])])},b=[],x=(n("96cf"),n("1da1")),y={name:"UploadPane",data:function(){return{posterFile:null,qrcodeFile:null}},methods:{handleClickUpload:function(e){"POSTER"===e?this.$refs["poster-input"].click():this.$refs["qrcode-input"].click()},posterUploadChange:function(e){var t=this;return Object(x["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.uploadChange(e,"POSTER");case 1:case"end":return n.stop()}}),n)})))()},qrcodeUploadChange:function(e){var t=this;return Object(x["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.uploadChange(e,"QRCODE");case 1:case"end":return n.stop()}}),n)})))()},uploadChange:function(e,t){var n=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){var a,i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.target.files[0],a){r.next=3;break}return r.abrupt("return",n.$Toast({message:"取消上传"}));case 3:return r.next=5,s(a);case 5:return i=r.sent,r.next=8,c(i);case 8:if(o=r.sent,"POSTER"!==t){r.next=14;break}return r.next=12,n.handlePosterUploadChange(a,o);case 12:r.next=16;break;case 14:return r.next=16,n.handleQrcodeUploadChange(a,o);case 16:case"end":return r.stop()}}),r)})))()},handlePosterUploadChange:function(e,t){var n=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n.posterFile=e,n.$store.commit("setPosterImg",t);case 2:case"end":return r.stop()}}),r)})))()},handleQrcodeUploadChange:function(e,t){var n=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){var a,i,o,s,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n.qrcodeFile=e,a=document.createElement("canvas"),i=a.getContext("2d"),o={x:244/861*t.width,y:535/1383*t.height,width:375/861*t.width,height:375/1383*t.height},a.width=String(Math.round(o.width)),a.height=a.width,a.style.width="100%",i.drawImage(t,-1*o.x,-1*o.y,t.width,t.height),s=a.toDataURL("image/png"),r.next=11,c(s);case 11:u=r.sent,n.$store.commit("setQrcodeImg",u);case 13:case"end":return r.stop()}}),r)})))()}}},I=y,O=(n("23bf"),Object(m["a"])(I,w,b,!1,null,"08482408",null)),_=O.exports,C={name:"App",components:{Preview:v,UploadPane:_}},k=C,P=(n("5c0b"),Object(m["a"])(k,i,o,!1,null,null,null)),j=P.exports;r["default"].use(p["a"]);var R=new p["a"].Store({state:{posterImg:null,qrcodeImg:null},mutations:{setPosterImg:function(e,t){e.posterImg=t},setQrcodeImg:function(e,t){e.qrcodeImg=t}},actions:{},modules:{}});n("aa35");r["default"].component(a["Button"].name,a["Button"]),r["default"].config.productionTip=!1,r["default"].prototype.$Toast=a["Toast"],new r["default"]({store:R,render:function(e){return e(j)}}).$mount("#app")},"58a4":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),a=n.n(r);a.a},"9b6e":function(e,t,n){"use strict";var r=n("58a4"),a=n.n(r);a.a},"9c0c":function(e,t,n){}});
//# sourceMappingURL=app.3ea3d7a2.js.map