(function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],l=0,d=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);p&&p(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={index:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var p=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0d1c":function(e,t,n){},"23bf":function(e,t,n){"use strict";var r=n("53c1"),o=n.n(r);o.a},"368f":function(e,t,n){"use strict";var r=n("0d1c"),o=n.n(r);o.a},"53c1":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=n("76a0"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"header-info"},[e._v("出品分行：深圳分行；用途：网点线上店海报制作")]),e._m(0),n("UploadPane"),n("Preview")],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-tip-wrapper"},[n("p",[e._v("提示")]),n("p",[e._v("- 微信/手机QQ 端使用「长按底部图片」进行保存")]),n("p",[e._v("- 其他端点击「下载按钮」进行保存")])])}];n("d3b7");function s(e){var t=new FileReader;return new Promise((function(n,r){t.onload=function(e){var t=e.target.result;n(t)},t.readAsDataURL(e)}))}function c(e){return new Promise((function(t,n){var r=new Image;r.setAttribute("crossOrigin","Anonymous"),r.onload=function(){t(r)},r.onerror=function(){n(arguments)},r.src=e}))}var u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preview-wrapper"},[n("div",{staticClass:"common-row operator"},[n("mt-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.posterTypeSelectionShow=!0}}},[e._v("选择海报模式")]),n("mt-button",{attrs:{type:"primary",size:"small",disabled:e.disabled},on:{click:e.draw}},[e._v(e._s(e.base64Img?"重新生成":"生成"))]),n("mt-button",{attrs:{type:"primary",size:"small",disabled:e.disabled},on:{click:e.download}},[e._v("下载")])],1),n("div",{staticClass:"common-row poster-type-info"},[n("p",[e._v(" 模式: "),n("span",{staticClass:"red"},[e._v(e._s(e.posterTypeInfo.name))])])]),n("div",{staticClass:"divide"}),e.base64Img?n("div",[n("img",{attrs:{src:e.base64Img}})]):e._e(),n("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"canvas"}),n("mt-popup",{attrs:{position:"bottom"},model:{value:e.posterTypeSelectionShow,callback:function(t){e.posterTypeSelectionShow=t},expression:"posterTypeSelectionShow"}},[n("div",{staticClass:"poster-type-selection"},[n("mt-radio",{attrs:{title:"选择海报模式",options:e.options},on:{change:e.optionChange},model:{value:e.posterType,callback:function(t){e.posterType=t},expression:"posterType"}})],1)])],1)},p=[],l=(n("d81d"),n("5530")),d=n("2f62"),h=[{name:"APP海报7.0 (1125x2436)",x:795/1125,y:1906/2436,width:250/1125,height:250/2436},{name:"APP海报8.0 (1125x2184)",x:814/1125,y:1965/2184,width:165/1125,height:165/2184}],f={name:"Preview",data:function(){return{ctx:null,base64Img:null,posterTypeSelectionShow:!1,options:h.map((function(e,t){return{label:e.name,value:String(t)}}))}},computed:Object(l["a"])(Object(l["a"])(Object(l["a"])({},Object(d["c"])(["posterImg","qrcodeImg"])),Object(d["b"])(["posterTypeInfo"])),{},{disabled:function(){return!this.posterImg||!this.qrcodeImg},posterType:{get:function(){return this.$store.state.posterType},set:function(e){return this.$store.commit("setPosterType",e)}}}),watch:{posterImg:function(e){var t=this;this.$nextTick((function(){t.draw()}))},qrcodeImg:function(e){var t=this;this.$nextTick((function(){t.draw()}))}},methods:{optionChange:function(){this.posterTypeSelectionShow=!1,this.draw()},draw:function(){if(!this.disabled){this.initCanvas(),this.ctx.drawImage(this.posterImg,0,0);var e={x:this.posterTypeInfo.x*this.posterImg.width,y:this.posterTypeInfo.y*this.posterImg.height,width:this.posterTypeInfo.width*this.posterImg.width,height:this.posterTypeInfo.height*this.posterImg.height};this.ctx.drawImage(this.qrcodeImg,e.x,e.y,e.width,e.height);var t=this.$refs["canvas"];this.base64Img=t.toDataURL("image/png")}},initCanvas:function(){var e=this.$refs["canvas"],t=e.getContext("2d");e.width=this.posterImg.width,e.height=this.posterImg.height,e.style.width="100%",this.ctx=t},download:function(){var e=navigator.userAgent;/wechat/.test(e.toLowerCase())&&this.$Toast("请长按图片保存");var t=document.createElement("a");t.download="pic_".concat(Date.now(),".png"),t.href=this.base64Img,t.click()}}},m=f,g=(n("368f"),n("2877")),v=Object(g["a"])(m,u,p,!1,null,"7b338990",null),w=v.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-pane-wrapper"},[n("div",{staticClass:"common-row"},[n("mt-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleClickUpload("POSTER")}}},[e._v("上传海报")]),n("mt-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleClickUpload("QRCODE")}}},[e._v("上传二维码")])],1),n("div",{staticClass:"filename-list"},[n("p",[e._v("海报文件名: "+e._s(this.posterFile&&this.posterFile.name))]),n("p",[e._v("二维码文件名: "+e._s(this.qrcodeFile&&this.qrcodeFile.name))])]),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[n("input",{ref:"poster-input",attrs:{type:"file"},on:{change:e.posterUploadChange}}),n("input",{ref:"qrcode-input",attrs:{type:"file"},on:{change:e.qrcodeUploadChange}})])])},y=[],x=(n("96cf"),n("1da1")),I={name:"UploadPane",data:function(){return{posterFile:null,qrcodeFile:null}},methods:{handleClickUpload:function(e){"POSTER"===e?this.$refs["poster-input"].click():this.$refs["qrcode-input"].click()},posterUploadChange:function(e){var t=this;return Object(x["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.uploadChange(e,"POSTER");case 1:case"end":return n.stop()}}),n)})))()},qrcodeUploadChange:function(e){var t=this;return Object(x["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.uploadChange(e,"QRCODE");case 1:case"end":return n.stop()}}),n)})))()},uploadChange:function(e,t){var n=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){var o,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(o=e.target.files[0],o){r.next=3;break}return r.abrupt("return",n.$Toast({message:"取消上传"}));case 3:return r.next=5,s(o);case 5:return a=r.sent,r.next=8,c(a);case 8:if(i=r.sent,"POSTER"!==t){r.next=14;break}return r.next=12,n.handlePosterUploadChange(o,i);case 12:r.next=16;break;case 14:return r.next=16,n.handleQrcodeUploadChange(o,i);case 16:case"end":return r.stop()}}),r)})))()},handlePosterUploadChange:function(e,t){var n=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n.posterFile=e,n.$store.commit("setPosterImg",t);case 2:case"end":return r.stop()}}),r)})))()},handleQrcodeUploadChange:function(e,t){var n=this;return Object(x["a"])(regeneratorRuntime.mark((function r(){var o,a,i,s,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n.qrcodeFile=e,o=document.createElement("canvas"),a=o.getContext("2d"),i={x:244/861*t.width,y:535/1383*t.height,width:375/861*t.width,height:375/1383*t.height},o.width=String(Math.round(i.width)),o.height=o.width,o.style.width="100%",a.drawImage(t,-1*i.x,-1*i.y,t.width,t.height),s=o.toDataURL("image/png"),r.next=11,c(s);case 11:u=r.sent,n.$store.commit("setQrcodeImg",u);case 13:case"end":return r.stop()}}),r)})))()}}},T=I,C=(n("23bf"),Object(g["a"])(T,b,y,!1,null,"08482408",null)),_=C.exports,O={name:"App",components:{Preview:w,UploadPane:_}},P=O,k=(n("5c0b"),Object(g["a"])(P,a,i,!1,null,null,null)),S=k.exports;n("a9e3");r["default"].use(d["a"]);var j=new d["a"].Store({state:{posterImg:null,qrcodeImg:null,posterType:"0"},getters:{posterTypeInfo:function(e){return h[Number(e.posterType)]}},mutations:{setPosterImg:function(e,t){e.posterImg=t},setQrcodeImg:function(e,t){e.qrcodeImg=t},setPosterType:function(e,t){e.posterType=t}}});n("aa35");r["default"].component(o["Button"].name,o["Button"]),r["default"].component(o["Popup"].name,o["Popup"]),r["default"].component(o["Radio"].name,o["Radio"]),r["default"].config.productionTip=!1,r["default"].prototype.$Toast=o["Toast"],new r["default"]({store:j,render:function(e){return e(S)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),o=n.n(r);o.a},"9c0c":function(e,t,n){}});
//# sourceMappingURL=index.ec07662d.js.map